const crypto = require('crypto'); 

const alicePublicKeyPem = `-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAreUDFt0HWuCSSXizy9sK
Bexi1b4cdZUW0Z3I7YwTPWPD2KJaUQafv2TB6uRy5ZznNqV9O/veAR7BejAgpWsx
n6EuxeHwMeEcxjvBDdH+CJqIg4ZJeP7YhooqEVWO5gvksK0V5FdysLj5kFGmmXpK
UTVMundc+1bOHUFpLWiMwpvn2QZI5PFix7NooNnfHX19j3allkdQmwB780K6qbCD
mtnSMlkzJIL9gtU08MR94m7aPddHu6xkNFzjZi81prhmZwYnSqH5+lC7/ewlJ0jc
MhUZGekpbCsqiM87LAtaBDagkZkTgMHxnHTTjgOJNLimADLLlEfjha/fqjSax4+f
wwIDAQAB
-----END PUBLIC KEY-----`;

const bobPrivateKey = `-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC69Jp5s/3VWIUD
tP5I06w/otlQDaF8vYoIHY/0h8eCxWcrJ5AaY7G1J+Ll7aIIVZDBgrApGnbPutkr
tdR64xzJ0/N/plUHrnu1GIAoWuzPWxZILc204m4sWeYd1C7wFaWlo4FmOCf9yXJW
dOJJTvsqnxQpC6nSMrwOi5pYaIkoDZQgrTBT9awdyurtmuBiLgvij1eH7iTW+BNj
fWkxUMC9GjvSPW4F02W6nEeokR3Brk0rpnYD7+T2J0R/n1C+EEhAqWI2aq2Yr3Xu
p+mO99XGKo4EKBWobjvwaneCuVrmyMZncnCMK/aEcnmUKlfh8z4ebS12vXaUdImC
LspmR1FfAgMBAAECggEAGxvi1mjqEqiOSRZSlP7UiDm15yzC0NKvFDQtLpkNrgGv
zwsikyEHoKwS86I8j5bQsa6gmqUyuzZtzS/Firgp8X4hXc4hoEaFu6G8250rn3mm
xnqVzHfU3+t9ObANylRpO5Z06fyUl/FA+hZixZyFQQ3mH3mIe2lN6ZIGpHEsCjmG
SyOb9hxA9jAALJu2iWxLer5QTXq0k/v/8mrfZ+4l/yqHp4wMJfJhzQ4cIUVjI2Ov
HKjZjYdPm4GN70R4Ez4w2WvRs9shTjR82a2fMSHuwEu9rDfxS4jQhTA0AeyetYXu
FIWV9pRP2DdSH+RoNS2UJadqa/883JzFlqhpjtCWUQKBgQDmuQltYvD4gdMMzESX
06vgi4Do/25YG4LHeGeLfqDmRlvb6VztSO7/JbrMCYxSgErmuexqMD+6goM9buV+
dkBYu9HSv7Jr9pvY4rW9mrEcheC7Bz9H7Tet7tjmdwabBalDkhg6ym8Ze5gTg9m4
MMOR81eq6u1g9+RWI00Nh2sSyQKBgQDPcAwXznMz7yEnvNuuRi6ib4yjm7u8tkU2
aOv0Mn80KWo49Dnr0erKwWLdgbjla0hyo2ctMaeRlB/oVThzpu0boNcnKkx4Oqn1
L6d5Rn2FOd0ZirnV2p7w+rvNK3gdDpsJU7RjYwNnpdJH6dT4w2AuP/JMfuQvQuut
/BjSal9u5wKBgFx0jbiNy25p577bJCmLIvcKMBAuO3OHIrL4JtYZWjSswSawrxJP
Baas4dvdf6OX0Wv/2SL8Tq1Ym2rEw6YXkNV9/ijrtH3bBry0rItcL9j0NQf9cXhL
MOK8MaK406bPb/Kp2pfEgxy9EEXRsi9DKzuTPfA50AHplFCIONpRB7ExAoGBAKrD
NFFMtG1mR0btI3Ldd3pklcQBaZS5/1QBH2xRPYH1LepgsmW80qnCdN6f8VN685Lb
jQ4ZODaRV4rszKH4ImyCBVvKaFT5Bfw/FICzVJUdwzNJjh3L8NezsHH/fMt+wIX3
ECJY2e6zBN4KUjXOsBiir5XlR3bYgichxlVBF/q1AoGAVUMO+hwOWe4i9phtWIx7
MjtQq0LQDehrb70Ta60eRXPt2fOJqZsd3nYBZ2VhZjpWTpWr3PTo5xVkQztBrQN6
lMaEl7/sS8u7Rp417PMxyLIfAGk9fyZc8tdQeLsZ6ucvFrX/FnOjSwpiGzorhO4d
Mi60yTkdbFUPU/t8ojiPdWQ=
-----END PRIVATE KEY-----`;

const recipientPrivateKey = crypto.createPrivateKey(bobPrivateKey);

const signature = 'a2670f1efb797a024f5c33a366a78218c133ba5c067a5ba7932b7f9ec7fdc5dc77a2eb77dca99c01de7950f6a1add33eb6c6c45bc4593aa52b4d52324bf89f92a037a01f4f8420a6856a7913028a322dca9dec9abf22a21930787a66cf8019bfb94683ba4f580fdf82f7666ebca1c1b17af6a5e309ccafe1eef710928635d5ebaaaf57b37741883be8e9950e53b41ed1fcd31ac2ba4cfbfb97761c3c5438e8a3e6d5948cc628ffafe73a3ed8a1d8311d246922b4a517f1415837ab3e5309096e59a9e01179330efcb72c036e304c6f782145dd05b9331ddde24f2a5ab8b360de9c56bf78894ba0a195e682cb3ba62bea429dff7d44b1795bb062a36e5017f008';
const ciphertextHex = '54def6cd4ee17c2ade9cae86559c7821e115233288728f7f4ce304e68a588f0da64b53be9b601fdc977aec2f6d0b2481a43c5c647cdd67cc4e637ec5cf90d4e53d6957a3c229eb08d9723040d0867e9839842c9cb459a9638003c2730e3160cdb5d323e85da4ec52a5fae2103b0d4beb3b607a0ea05ea3a67f937022d4e974d6c92b495be526a5fd9ae7dea7504d4060ff1e738d6a180a12e6e977e628e1d0ec6a5c386936e13b431c0882ec54fcabca83438dd01db8ae2e67e4d6d9b8d3769ee2f51a0ede2f2edcbed24af7cf58827303b469195a8a8d7c8eb0d6c7348ed23ceb6250853981ea049e98aa5157b52fa34401f797f22f76ccd78c4afd530ff0e8';
const ciphertext = Buffer.from(ciphertextHex, "hex");

const recoveredPlaintext = crypto.privateDecrypt(recipientPrivateKey, ciphertext);


const verify = crypto.createVerify('SHA256');  
verify.update(recoveredPlaintext);  
verify.end();  
const isVerified = verify.verify(alicePublicKeyPem, signature, 'hex');  


console.log(`Signature Verification: ${isVerified}`);  
console.log(`Message: ${recoveredPlaintext}`);  